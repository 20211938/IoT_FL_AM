[로그 저장] 로그 파일: logs\training_log_20251120_104746.txt
================================================================================
학습 시작 시간: 2025-11-20 10:47:46
================================================================================

[Device] cuda

[결함 유형 분석]
  - 데이터 디렉토리: data/labeled_layers
  - 최소 샘플 수: 10
  - 디렉토리 수: 47개

[발견된 결함 유형] (최소 10개 이상)
  - Super Elevation: 4819개
  - Recoater Streaking: 3746개
  - Fail: 1141개
  - Laser capture timing error: 1089개
  - Reocater Streaking: 615개
  - Recoater capture timing error: 309개

[클래스 매핑] 총 7개 클래스
  - 클래스 0: Normal
  - 클래스 1: Super Elevation
  - 클래스 2: Recoater Streaking
  - 클래스 3: Fail
  - 클래스 4: Laser capture timing error
  - 클래스 5: Reocater Streaking
  - 클래스 6: Recoater capture timing error

[데이터 로딩] 디렉토리 검색 중: data/labeled_layers
[데이터 로딩] 발견된 데이터베이스 디렉토리: 47개
  - 20210909_2131_D160: 30개 이미지 발견
  - 20210913_2011_D160: 6개 이미지 발견
  - 20210914_1755_D160: 5개 이미지 발견
  - 20210914_1910_D120: 43개 이미지 발견
  - 20210923_1350_D160: 6개 이미지 발견
  - 20210924_2038_D160: 6개 이미지 발견
  - 20211228_1943_D160: 7개 이미지 발견
  - 20211230_1601_D160: 721개 이미지 발견
[데이터 로딩] 처리 중: 10/47 디렉토리...
  - 20220106_1756_D160: 30개 이미지 발견
  - 20220110_2030_D120: 55개 이미지 발견
  - 20220111_2155_D120: 255개 이미지 발견
  - 20220112_1121_D120: 784개 이미지 발견
  - 20220119_1146_D120: 235개 이미지 발견
  - 20220327_2148_D160: 2개 이미지 발견
  - 20220412_2029_D160: 154개 이미지 발견
  - 20220413_1143_D160: 857개 이미지 발견
  - 20220422_1649_D160: 14개 이미지 발견
  - 20220428_2028_D160: 25개 이미지 발견
[데이터 로딩] 처리 중: 20/47 디렉토리...
  - 20220503_1734_M160: 985개 이미지 발견
  - 20220504_1932_M160: 624개 이미지 발견
  - 20220511_1843_M160: 91개 이미지 발견
  - 20220516_1714_M160: 61개 이미지 발견
  - 20220519_1821_M160: 4개 이미지 발견
  - 20220523_2052_M160: 184개 이미지 발견
  - 20220524_1614_M160: 53개 이미지 발견
  - 20220524_2012_M160: 60개 이미지 발견
  - 20220525_1723_M160: 8개 이미지 발견
  - 20220530_1616_M160: 1232개 이미지 발견
[데이터 로딩] 처리 중: 30/47 디렉토리...
  - 20220531_2227_M160: 37개 이미지 발견
  - 20220601_1356_M160: 7개 이미지 발견
  - 20220601_1719_M160: 9개 이미지 발견
  - 20220605_1508_M160: 44개 이미지 발견
  - 20220605_1810_M160: 13개 이미지 발견
  - 20220606_0211_M160: 595개 이미지 발견
  - 20220616_2103_M160: 70개 이미지 발견
  - 20220622_1617_M160: 395개 이미지 발견
  - 20220623_2229_M160: 31개 이미지 발견
  - 20220628_1112_M160: 268개 이미지 발견
[데이터 로딩] 처리 중: 40/47 디렉토리...
  - 20220629_1632_M160: 64개 이미지 발견
  - 20220629_2104_M160: 183개 이미지 발견
  - 20220630_1035_M160: 30개 이미지 발견
  - 20220704_1812_M160: 425개 이미지 발견
  - 20220712_1916_M160: 340개 이미지 발견
  - 20220713_2322_M160: 11개 이미지 발견
  - 20220714_2256_M160: 391개 이미지 발견
  - 20220716_1706_M160: 215개 이미지 발견
[데이터 로딩] 완료! 총 9665개 이미지 로드됨

[데이터 분할]
  - 학습: 7732개
  - 검증: 1933개
[최적화] Label Smoothing 활성화: 0.1
[최적화] CosineAnnealingLR 스케줄러 사용 (T_max=300, eta_min=1e-6)
[하이퍼파라미터]
  - 모델: resnet34 (Pretrained)
  - 학습률: 0.0001
  - Weight Decay: 0.0001
  - 이미지 크기: 224x224
  - 데이터 증강: 활성화 (강화됨)
  - Label Smoothing: 0.1
[최적화] Mixed Precision Training (AMP) 활성화
[최적화] CUDA 스트림 활성화, num_workers=8, prefetch_factor=8

[학습 시작]
  - 에포크: 300
  - 배치 크기: 32
  - 조기 종료 기준: 검증 정확도 98.0% 도달

[Epoch 1/300]
  Train Loss: 0.9713, Train Acc: 76.75%
  Val Loss: 0.7101, Val Acc: 88.46%
  -> 최고 모델 저장: checkpoints\defect_type_classifier_best.pth (Val Acc: 88.46%)

[Epoch 2/300]
  Train Loss: 0.7766, Train Acc: 86.05%
  Val Loss: 0.6756, Val Acc: 89.65%
  -> 최고 모델 저장: checkpoints\defect_type_classifier_best.pth (Val Acc: 89.65%)

[Epoch 3/300]
  Train Loss: 0.7325, Train Acc: 87.22%
  Val Loss: 0.6756, Val Acc: 89.55%

[Epoch 4/300]
  Train Loss: 0.7137, Train Acc: 88.28%
  Val Loss: 0.6402, Val Acc: 91.10%
  -> 최고 모델 저장: checkpoints\defect_type_classifier_best.pth (Val Acc: 91.10%)

[Epoch 5/300]
  Train Loss: 0.6928, Train Acc: 89.12%
  Val Loss: 0.6512, Val Acc: 90.02%

[Epoch 6/300]
  Train Loss: 0.6914, Train Acc: 89.10%
  Val Loss: 0.6304, Val Acc: 91.77%
  -> 최고 모델 저장: checkpoints\defect_type_classifier_best.pth (Val Acc: 91.77%)

[Epoch 7/300]
  Train Loss: 0.6799, Train Acc: 89.59%
  Val Loss: 0.6388, Val Acc: 91.67%

[Epoch 8/300]
  Train Loss: 0.6741, Train Acc: 89.67%
  Val Loss: 0.6346, Val Acc: 92.14%
  -> 최고 모델 저장: checkpoints\defect_type_classifier_best.pth (Val Acc: 92.14%)

[Epoch 9/300]
  Train Loss: 0.6697, Train Acc: 90.27%
  Val Loss: 0.6131, Val Acc: 91.52%

[Epoch 10/300]
  Train Loss: 0.6630, Train Acc: 89.98%
  Val Loss: 0.6185, Val Acc: 92.45%
  -> 최고 모델 저장: checkpoints\defect_type_classifier_best.pth (Val Acc: 92.45%)

[Epoch 11/300]
  Train Loss: 0.6518, Train Acc: 90.57%
  Val Loss: 0.6320, Val Acc: 90.95%

[Epoch 12/300]
  Train Loss: 0.6500, Train Acc: 90.95%
  Val Loss: 0.6150, Val Acc: 91.41%

[Epoch 13/300]
  Train Loss: 0.6533, Train Acc: 90.79%
  Val Loss: 0.6079, Val Acc: 92.34%

[Epoch 14/300]
  Train Loss: 0.6510, Train Acc: 90.82%
  Val Loss: 0.6069, Val Acc: 92.19%

[Epoch 15/300]
  Train Loss: 0.6470, Train Acc: 90.62%
  Val Loss: 0.6206, Val Acc: 92.50%
  -> 최고 모델 저장: checkpoints\defect_type_classifier_best.pth (Val Acc: 92.50%)

[Epoch 16/300]
  Train Loss: 0.6430, Train Acc: 90.92%
  Val Loss: 0.6058, Val Acc: 92.19%

[Epoch 17/300]
  Train Loss: 0.6420, Train Acc: 91.22%
  Val Loss: 0.6363, Val Acc: 91.88%

[Epoch 18/300]
  Train Loss: 0.6452, Train Acc: 90.69%
  Val Loss: 0.6106, Val Acc: 91.98%

[Epoch 19/300]
  Train Loss: 0.6371, Train Acc: 91.54%
  Val Loss: 0.6016, Val Acc: 92.50%

[Epoch 20/300]
  Train Loss: 0.6367, Train Acc: 91.33%
  Val Loss: 0.6031, Val Acc: 92.50%
