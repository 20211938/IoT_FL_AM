# 결함 유형 분류 모델 학습 결과

## 📊 학습 개요

- **Device**: CPU
- **데이터**: 9,665개 (학습: 7,732개, 검증: 1,933개)
- **클래스**: 7개 (Normal, Super Elevation, Recoater Streaking, Fail, Laser capture timing error, Reocater Streaking, Recoater capture timing error)
- **에포크**: 20
- **배치 크기**: 32

## 🎯 주요 성능

- **최고 검증 정확도**: **92.91%** (Epoch 18)
- **최종 검증 정확도**: 92.34%
- **최종 학습 정확도**: 91.46%
- **과적합**: 없음 (검증 정확도 ≥ 학습 정확도)

## 📈 에포크별 성능

| Epoch | Train Loss | Train Acc | Val Loss | Val Acc | 최고 |
|-------|------------|-----------|----------|---------|------|
| 1 | 0.9416 | 65.26% | 0.5649 | 81.01% | ✓ |
| 5 | 0.4071 | 86.06% | 0.4147 | 86.45% | ✓ |
| 10 | 0.3118 | 89.33% | 0.2862 | 89.71% | |
| 15 | 0.2540 | 90.93% | 0.2553 | 92.24% | ✓ |
| **18** | **0.2441** | **91.46%** | **0.2295** | **92.91%** | **✓** |
| 20 | 0.2366 | 91.46% | 0.2466 | 92.34% | |

## 📊 학습 분석

### 긍정적
- ✅ 안정적인 수렴 (손실 지속 감소)
- ✅ 과적합 없음
- ✅ 빠른 초기 학습 (Epoch 1-5)

### 주의사항
- ⚠️ Epoch 7에서 검증 손실 일시 증가 후 회복
- ⚠️ Epoch 18 이후 약간의 성능 하락 (Early Stopping 고려)
- ⚠️ CPU 사용으로 학습 시간 길음 (에포크당 7-9분)

## 💡 개선 방안

1. **GPU 사용**: 학습 시간 대폭 단축
2. **Early Stopping**: Epoch 18에서 조기 종료
3. **클래스 가중치**: 소수 클래스 성능 개선
4. **데이터 증강**: 소수 클래스 강화

## 📝 결론

**92.91%의 검증 정확도**를 달성하여 우수한 성능을 보였습니다. 안정적인 학습 곡선과 과적합 없는 일반화 성능이 확인되었습니다.

**최고 모델**: `checkpoints/defect_type_classifier_best.pth` (Epoch 18)

---

# 결함 유형 분류 모델 학습 결과 (GPU 버전)

## 📊 학습 개요

- **Device**: CUDA (GPU)
- **데이터**: 9,665개 (학습: 7,732개, 검증: 1,933개)
- **클래스**: 7개 (Normal, Super Elevation, Recoater Streaking, Fail, Laser capture timing error, Reocater Streaking, Recoater capture timing error)
- **에포크**: 20
- **배치 크기**: 32
- **최적화**: num_workers=4, pin_memory=True, persistent_workers=True

## 🎯 주요 성능

- **최고 검증 정확도**: **92.45%** (Epoch 12)
- **최종 검증 정확도**: 91.62%
- **최종 학습 정확도**: 91.31%
- **과적합**: 없음 (검증 정확도 ≥ 학습 정확도)
- **학습 속도**: 에포크당 약 2분 (CPU 대비 약 3-4배 빠름)

## 📈 에포크별 성능

| Epoch | Train Loss | Train Acc | Val Loss | Val Acc | 최고 |
|-------|------------|-----------|----------|---------|------|
| 1 | 1.0924 | 55.72% | 0.5665 | 83.39% | ✓ |
| 5 | 0.4163 | 86.34% | 2.0124 | 36.06% | |
| 10 | 0.3070 | 89.37% | 0.3851 | 85.93% | |
| **12** | **0.2690** | **90.34%** | **0.2579** | **92.45%** | **✓** |
| 15 | 0.2505 | 91.08% | 0.2846 | 90.48% | |
| 20 | 0.2390 | 91.31% | 0.2353 | 91.62% | |

## 📊 학습 분석

### 긍정적
- ✅ GPU 사용으로 학습 시간 대폭 단축 (에포크당 2분 vs 7-9분)
- ✅ 안정적인 수렴 (손실 지속 감소)
- ✅ 과적합 없음
- ✅ 빠른 초기 학습 (Epoch 1에서 83.39% 달성)

### 주의사항
- ⚠️ Epoch 5에서 검증 손실 급증 (2.0124) 후 회복
- ⚠️ Epoch 12 이후 성능 하락 (92.45% → 91.62%)
- ⚠️ 최고 성능이 이전 CPU 학습(92.91%)보다 약간 낮음

## 💡 개선 방안

1. **배치 크기 증가**: GPU 메모리 여유 시 64-128로 증가
2. **Early Stopping**: Epoch 12에서 조기 종료
3. **학습률 조정**: 초기 학습률 낮추기
4. **데이터 증강**: 소수 클래스 강화

## 📝 결론

**92.45%의 검증 정확도**를 달성하여 우수한 성능을 보였습니다. GPU 사용으로 학습 시간이 크게 단축되었으며(약 3-4배), 안정적인 학습 곡선을 보였습니다.

**최고 모델**: `checkpoints/defect_type_classifier_best.pth` (Epoch 12)

## 🔄 CPU vs GPU 비교

| 항목 | CPU 버전 | GPU 버전 |
|------|----------|----------|
| 최고 검증 정확도 | 92.91% (Epoch 18) | 92.45% (Epoch 12) |
| 학습 시간/에포크 | 7-9분 | 약 2분 |
| 총 학습 시간 (20 에포크) | 약 2.5-3시간 | 약 40분 |
| GPU 사용률 | N/A | 최적화됨 |
| 최적화 옵션 | 없음 | num_workers, pin_memory |
