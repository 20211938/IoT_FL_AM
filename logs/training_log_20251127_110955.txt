[로그 저장] 로그 파일: logs\training_log_20251127_110955.txt
================================================================================
학습 시작 시간: 2025-11-27 11:09:55
================================================================================

[Device] cuda

[결함 유형 분석]
  - 데이터 디렉토리: data
  - 최소 샘플 수: 10
  - 발견된 이미지 파일: 9367개

[발견된 결함 유형] (최소 10개 이상)
  - Super Elevation: 3381개
  - Recoater Streaking: 2856개
  - Spatter: 1316개
  - Humping: 1215개
  - Reocater Streaking: 599개

[클래스 매핑] 총 6개 클래스
  - 클래스 0: Normal
  - 클래스 1: Super Elevation
  - 클래스 2: Recoater Streaking
  - 클래스 3: Spatter
  - 클래스 4: Humping
  - 클래스 5: Reocater Streaking

[데이터 로딩] 디렉토리 검색 중: data
[데이터 로딩] 발견된 이미지 파일: 9367개
[데이터 로딩] 처리 중: 100/9367 파일...
[데이터 로딩] 처리 중: 200/9367 파일...
[데이터 로딩] 처리 중: 300/9367 파일...
[데이터 로딩] 처리 중: 400/9367 파일...
[데이터 로딩] 처리 중: 500/9367 파일...
[데이터 로딩] 처리 중: 600/9367 파일...
[데이터 로딩] 처리 중: 700/9367 파일...
[데이터 로딩] 처리 중: 800/9367 파일...
[데이터 로딩] 처리 중: 900/9367 파일...
[데이터 로딩] 처리 중: 1000/9367 파일...
[데이터 로딩] 처리 중: 1100/9367 파일...
[데이터 로딩] 처리 중: 1200/9367 파일...
[데이터 로딩] 처리 중: 1300/9367 파일...
[데이터 로딩] 처리 중: 1400/9367 파일...
[데이터 로딩] 처리 중: 1500/9367 파일...
[데이터 로딩] 처리 중: 1600/9367 파일...
[데이터 로딩] 처리 중: 1700/9367 파일...
[데이터 로딩] 처리 중: 1800/9367 파일...
[데이터 로딩] 처리 중: 1900/9367 파일...
[데이터 로딩] 처리 중: 2000/9367 파일...
[데이터 로딩] 처리 중: 2100/9367 파일...
[데이터 로딩] 처리 중: 2200/9367 파일...
[데이터 로딩] 처리 중: 2300/9367 파일...
[데이터 로딩] 처리 중: 2400/9367 파일...
[데이터 로딩] 처리 중: 2500/9367 파일...
[데이터 로딩] 처리 중: 2600/9367 파일...
[데이터 로딩] 처리 중: 2700/9367 파일...
[데이터 로딩] 처리 중: 2800/9367 파일...
[데이터 로딩] 처리 중: 2900/9367 파일...
[데이터 로딩] 처리 중: 3000/9367 파일...
[데이터 로딩] 처리 중: 3100/9367 파일...
[데이터 로딩] 처리 중: 3200/9367 파일...
[데이터 로딩] 처리 중: 3300/9367 파일...
[데이터 로딩] 처리 중: 3400/9367 파일...
[데이터 로딩] 처리 중: 3500/9367 파일...
[데이터 로딩] 처리 중: 3600/9367 파일...
[데이터 로딩] 처리 중: 3700/9367 파일...
[데이터 로딩] 처리 중: 3800/9367 파일...
[데이터 로딩] 처리 중: 3900/9367 파일...
[데이터 로딩] 처리 중: 4000/9367 파일...
[데이터 로딩] 처리 중: 4100/9367 파일...
[데이터 로딩] 처리 중: 4200/9367 파일...
[데이터 로딩] 처리 중: 4300/9367 파일...
[데이터 로딩] 처리 중: 4400/9367 파일...
[데이터 로딩] 처리 중: 4500/9367 파일...
[데이터 로딩] 처리 중: 4600/9367 파일...
[데이터 로딩] 처리 중: 4700/9367 파일...
[데이터 로딩] 처리 중: 4800/9367 파일...
[데이터 로딩] 처리 중: 4900/9367 파일...
[데이터 로딩] 처리 중: 5000/9367 파일...
[데이터 로딩] 처리 중: 5100/9367 파일...
[데이터 로딩] 처리 중: 5200/9367 파일...
[데이터 로딩] 처리 중: 5300/9367 파일...
[데이터 로딩] 처리 중: 5400/9367 파일...
[데이터 로딩] 처리 중: 5500/9367 파일...
[데이터 로딩] 처리 중: 5600/9367 파일...
[데이터 로딩] 처리 중: 5700/9367 파일...
[데이터 로딩] 처리 중: 5800/9367 파일...
[데이터 로딩] 처리 중: 5900/9367 파일...
[데이터 로딩] 처리 중: 6000/9367 파일...
[데이터 로딩] 처리 중: 6100/9367 파일...
[데이터 로딩] 처리 중: 6200/9367 파일...
[데이터 로딩] 처리 중: 6300/9367 파일...
[데이터 로딩] 처리 중: 6400/9367 파일...
[데이터 로딩] 처리 중: 6500/9367 파일...
[데이터 로딩] 처리 중: 6600/9367 파일...
[데이터 로딩] 처리 중: 6700/9367 파일...
[데이터 로딩] 처리 중: 6800/9367 파일...
[데이터 로딩] 처리 중: 6900/9367 파일...
[데이터 로딩] 처리 중: 7000/9367 파일...
[데이터 로딩] 처리 중: 7100/9367 파일...
[데이터 로딩] 처리 중: 7200/9367 파일...
[데이터 로딩] 처리 중: 7300/9367 파일...
[데이터 로딩] 처리 중: 7400/9367 파일...
[데이터 로딩] 처리 중: 7500/9367 파일...
[데이터 로딩] 처리 중: 7600/9367 파일...
[데이터 로딩] 처리 중: 7700/9367 파일...
[데이터 로딩] 처리 중: 7800/9367 파일...
[데이터 로딩] 처리 중: 7900/9367 파일...
[데이터 로딩] 처리 중: 8000/9367 파일...
[데이터 로딩] 처리 중: 8100/9367 파일...
[데이터 로딩] 처리 중: 8200/9367 파일...
[데이터 로딩] 처리 중: 8300/9367 파일...
[데이터 로딩] 처리 중: 8400/9367 파일...
[데이터 로딩] 처리 중: 8500/9367 파일...
[데이터 로딩] 처리 중: 8600/9367 파일...
[데이터 로딩] 처리 중: 8700/9367 파일...
[데이터 로딩] 처리 중: 8800/9367 파일...
[데이터 로딩] 처리 중: 8900/9367 파일...
[데이터 로딩] 처리 중: 9000/9367 파일...
[데이터 로딩] 처리 중: 9100/9367 파일...
[데이터 로딩] 처리 중: 9200/9367 파일...
[데이터 로딩] 처리 중: 9300/9367 파일...
[데이터 로딩] 완료! 총 9367개 이미지 로드됨

[데이터 분할] 랜덤 셔플 후 분할
  - 학습: 6556개 (70%)
  - 검증: 1405개 (15%)
  - 테스트: 1406개 (15%)

[레이블 분포 확인]
  학습: 단일 레이블 6556개 (100.0%), 다중 레이블 0개 (0.0%)
  검증: 단일 레이블 1405개 (100.0%), 다중 레이블 0개 (0.0%)
  테스트: 단일 레이블 1406개 (100.0%), 다중 레이블 0개 (0.0%)

[데이터 분할]
  - 학습: 6556개 (70%)
  - 검증: 1405개 (15%)
  - 테스트: 1406개 (15%)
[모델 설정] 다중 레이블 분류 모드 (BCEWithLogitsLoss 사용)
[참고] Label Smoothing은 다중 레이블에서 자동으로 적용되지 않습니다.
[최적화] CosineAnnealingLR 스케줄러 사용 (T_max=300, eta_min=1e-6)
[하이퍼파라미터]
  - 모델: resnet34 (Pretrained)
  - 학습률: 0.0001
  - Weight Decay: 0.0001
  - 이미지 크기: 224x224
  - 데이터 증강: 활성화 (강화됨)
  - Label Smoothing: 0.1
[최적화] Mixed Precision Training (AMP) 활성화
[최적화] CUDA 스트림 활성화, num_workers=8, prefetch_factor=8

[학습 시작]
  - 에포크: 300
  - 배치 크기: 32
  - 조기 종료 기준: 검증 정확도 98.0% 도달

[Epoch 1/300]
  Train Loss: 0.1807, Train Acc: 68.91% (다중 레이블 정확도)
  Val Loss: 0.0513, Val Acc: 93.88% (다중 레이블 정확도)
  -> 최고 모델 저장: checkpoints\defect_type_classifier_best.pth (Val Acc: 93.88%)

[Epoch 2/300]
  Train Loss: 0.0768, Train Acc: 89.78% (다중 레이블 정확도)
  Val Loss: 0.0409, Val Acc: 95.59% (다중 레이블 정확도)
  -> 최고 모델 저장: checkpoints\defect_type_classifier_best.pth (Val Acc: 95.59%)

[Epoch 3/300]
  Train Loss: 0.0566, Train Acc: 92.82% (다중 레이블 정확도)
  Val Loss: 0.0396, Val Acc: 96.09% (다중 레이블 정확도)
  -> 최고 모델 저장: checkpoints\defect_type_classifier_best.pth (Val Acc: 96.09%)

[Epoch 4/300]
  Train Loss: 0.0497, Train Acc: 93.82% (다중 레이블 정확도)
  Val Loss: 0.0277, Val Acc: 97.44% (다중 레이블 정확도)
  -> 최고 모델 저장: checkpoints\defect_type_classifier_best.pth (Val Acc: 97.44%)

[Epoch 5/300]
  Train Loss: 0.0412, Train Acc: 94.81% (다중 레이블 정확도)
  Val Loss: 0.0290, Val Acc: 97.01% (다중 레이블 정확도)

[Epoch 6/300]
  Train Loss: 0.0398, Train Acc: 95.20% (다중 레이블 정확도)
  Val Loss: 0.0186, Val Acc: 98.22% (다중 레이블 정확도)
  -> 최고 모델 저장: checkpoints\defect_type_classifier_best.pth (Val Acc: 98.22%)

[조기 종료] 목표 정확도 98.0% 도달!
  - 현재 검증 정확도: 98.22%
  - 학습 중단 (Epoch 6/300)

[최종 테스트 평가]
================================================================================
  - 테스트 손실: 0.0171
  - 테스트 정확도: 98.44% (다중 레이블 정확도)
================================================================================

[학습 완료]
  - 최고 검증 정확도: 98.22%
  - 최종 테스트 정확도: 98.44%
  - 최종 에포크: 6/300
  - 총 학습 시간: 00:11:50 (710.75초)
  - 에포크당 평균 시간: 118.46초

[학습 히스토리 그래프]
  - 저장 경로: checkpoints\training_history.png
  - 총 에포크: 6
  - 학습 히스토리 그래프 저장 완료: checkpoints/training_history.png

[샘플 예측 결과]
  - 저장 경로: checkpoints\sample_predictions.png
  - 표시된 샘플 수: 3

====================================================================================================
실제 예측 결과 표
====================================================================================================
번호     이미지 파일명                                  실제 레이블                         예측 레이블                         정확도       
----------------------------------------------------------------------------------------------------
1      20220704_1812_M160_layer0890_62e1f664d0157ff8fb37b8a3.jpg Super Elevation                Super Elevation                ✓ 정확      
2      20220530_1616_M160_layer0980_62e766783553bae26281a6ef.jpg Recoater Streaking             Recoater Streaking             ✓ 정확      
3      20220524_1614_M160_layer0004_62e76e483553bae26281ac8b.jpg Super Elevation                Super Elevation                ✓ 정확      
====================================================================================================
  - 샘플 예측 결과 저장 완료: checkpoints/sample_predictions.png
================================================================================
학습 종료 시간: 2025-11-27 11:22:04
로그 파일 저장 완료: logs\training_log_20251127_110955.txt
================================================================================
